<!doctype html>
<html>
<head>
    <title>Manage Users</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='base.css') }}">
</head>
<body>
<body>
<div class="header">
    <div class="links">
        <span style="margin-right:20px; font-weight:bold;">Active Tuner: {{ current_tuner }}</span>
        <a href="{{ url_for('guide') }}">HOME</a>
        {% if current_user is defined and current_user.username == 'admin' %}
        <!-- ✅ Added next to USER ADMIN -->
		<a href="{{ url_for('manage_users') }}" id="manageUsersMenu">MANAGE USERS</a>
        {% endif %}

        <div class="dropdown" id="settingsMenu">
            <button class="dropbtn">SETTINGS ▾</button>
            <div class="dropdown-content">
                {% if current_user is defined and current_user.username == 'admin' %}
                <a href="{{ url_for('change_tuner') }}">Change Tuner</a>
                <a href="{{ url_for('view_logs') }}">Logs</a>
                <li><a href="{{ url_for('about') }}">About</a></li>
                {% endif %}
                <a href="{{ url_for('change_password') }}">Change Password</a>
				<li class="submenu">
				  <a href="#">Themes</a>
				  <ul class="submenu-content">
				    <li><a href="#" onclick="setTheme('light'); return false;">Light</a></li>
				    <li><a href="#" onclick="setTheme('dark'); return false;">Dark</a></li>
					<li><a href="#" onclick="setTheme('retro-aol'); return false;">AOL / CompuServe</a></li>
					<li><a href="#" onclick="setTheme('retro-magazine'); return false;">TV Guide Magazine</a></li>
					<li><a href="#" onclick="setTheme('directv'); return false;">DirecTV</a></li>
					<li><a href="#" onclick="setTheme('comcast'); return false;">Comcast</a></li>
				  </ul>
				</li>
            </div>
        </div>

        <a href="{{ url_for('logout') }}">LOGOUT</a>
    </div>
    <div id="clock" class="clock">--:-- --</div>
</div>

<div class="container">
    <h2>Manage Users</h2>
    <form method="POST">
        <h3>Add New User</h3>
        <input type="hidden" name="action" value="add">
        <input type="text" name="username" placeholder="Username" required>
        <input type="password" name="password" placeholder="Password" required>
        <button class="add" type="submit">Add User</button>
    </form>

    <h3>Existing Users</h3>
    <table>
        <tr><th>Username</th><th>Actions</th></tr>
        {% for user in users %}
        <tr>
            <td>{{ user }}</td>
            <td class="actions">
                <form method="POST" style="display:inline;">
                    <input type="hidden" name="username" value="{{ user }}">
                    <input type="hidden" name="action" value="delete">
                    <button class="danger" type="submit">Delete</button>
                </form>
                <form method="POST" style="display:inline;">
                    <input type="hidden" name="username" value="{{ user }}">
                    <input type="hidden" name="action" value="signout">
                    <button class="warn" type="submit">Sign Out All</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for msg in messages %}
          <p style="color:yellow;">{{ msg }}</p>
        {% endfor %}
      {% endif %}
    {% endwith %}
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const saved = localStorage.getItem("theme") || "dark";
    setTheme(saved);
    updateClock();
    setInterval(updateClock, 1000);
});
function setTheme(theme){
    const body=document.body;
    body.classList.remove("light","dark","retro-tvguide","retro-aol","retro-webtv","retro-tvguide2000","retro-magazine","directv","comcast");
    body.classList.add(theme);
    localStorage.setItem("theme",theme);
}
function updateClock(){
    const now=new Date();
    const el=document.getElementById('clock');
    if(el){
        el.textContent=now.toLocaleString([],{
            weekday:'short',month:'short',day:'numeric',
            hour:'2-digit',minute:'2-digit',second:'2-digit'
        });
    }
}
</script>
</body>
</html>
