<div class="header" role="banner">
  <!-- Mobile hamburger visible on small screens -->
  <button class="hamburger" id="mobileHamburger" aria-controls="mobileNav" aria-expanded="false" aria-label="Open navigation">
    <svg width="20" height="14" viewBox="0 0 20 14" aria-hidden="true"><rect width="20" height="2"></rect><rect y="6" width="20" height="2"></rect><rect y="12" width="20" height="2"></rect></svg>
  </button>

  <div class="links" role="navigation" aria-label="Main navigation">
      <span style="margin-right:20px; font-weight:bold;">Active Tuner: {{ current_tuner }}</span>
      <a href="{{ url_for('guide') }}">HOME</a>

      <div class="dropdown" id="settingsMenu">
          <button class="dropbtn">SETTINGS ▾</button>
          <div class="dropdown-content">
              {% if current_user is defined and current_user.username == 'admin' %}
              <li class="submenu">
                <a href="#">Change Tuner</a>
                <ul class="submenu-content">
                  {% if tuner_names is defined and tuner_names %}
                    {% for t in tuner_names %}
                      <li><a href="{{ url_for('set_tuner', name=t) }}">{{ t }}</a></li>
                    {% endfor %}
                  {% endif %}
                  <li class="separator"></li>
                  <li><a href="{{ url_for('change_tuner') }}">Tuner Management…</a></li>
                </ul>
              </li>
              <a href="{{ url_for('manage_users') }}" id="manageUsersMenu">Manage Users</a>
              <a href="{{ url_for('view_logs') }}">Logs</a>
              <li><a href="{{ url_for('about') }}">About</a></li>
              {% endif %}
              <li class="submenu">
                <a href="#">Auto-Scroll</a>
                <ul class="submenu-content">
                  <li><a href="#" id="toggleAutoScroll">Enable/Disable Auto-Scroll</a></li>
                  <li class="submenu">
                    <a href="#">Scroll Speed</a>
                    <ul class="submenu-content">
                      <li><a href="#" data-scroll-speed="slow">Slow</a></li>
                      <li><a href="#" data-scroll-speed="medium">Medium</a></li>
                      <li><a href="#" data-scroll-speed="fast">Fast</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <a href="{{ url_for('change_password') }}">Change Password</a>
              <li class="submenu">
                <a href="#">Themes</a>
                <ul class="submenu-content">
                  <li><a href="#" data-theme-selector data-theme="auto">Auto (System)</a></li>
                  <li><a href="#" data-theme-selector data-theme="retroiptv">RetroIPTV</a></li>
                  <li><a href="#" data-theme-selector data-theme="light">Light</a></li>
                  <li><a href="#" data-theme-selector data-theme="dark">Dark</a></li>
                  <li><a href="#" data-theme-selector data-theme="retro-aol">AOL / CompuServe</a></li>
                  <li><a href="#" data-theme-selector data-theme="retro-magazine">TV Guide (Refresh)</a></li>
		  <!-- <li><a href="#" data-theme-selector data-theme="tvguide1990">TV Guide (Classic)</a></li> -->
                  <li><a href="#" data-theme-selector data-theme="directv">DirecTV</a></li>
                  <li><a href="#" data-theme-selector data-theme="comcast">Comcast</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">Display Size</a>
                <ul class="submenu-content">
                  <li><a href="#" data-display-size-selector data-display-size="large">Large</a></li>
                  <li><a href="#" data-display-size-selector data-display-size="medium">Medium</a></li>
                  <li><a href="#" data-display-size-selector data-display-size="small">Small</a></li>
                </ul>
              </li>
          </div>
      </div>

      <a href="{{ url_for('logout') }}">LOGOUT</a>
  </div>

  <div id="clock" class="clock">--:-- --</div>
</div>

<!-- Off-canvas mobile nav (hidden by default, toggled by hamburger) -->
<nav id="mobileNav" class="mobile-nav" aria-hidden="true">
  <div class="mobile-nav-inner" role="menu">
    <div class="mobile-nav-header">
      <strong>IPTV GUIDE</strong>
      <button id="mobileNavClose" aria-label="Close navigation">&times;</button>
    </div>

    <ul class="mobile-links" role="menubar">
      <li role="none"><a role="menuitem" href="{{ url_for('guide') }}">HOME</a></li>
      {% if current_user is defined and current_user.username == 'admin' %}
      {# moved Manage Users under the Settings submenu for mobile too #}
      {# previously a top-level item; now grouped under Settings #}
      {% endif %}

      <!-- Settings collapsible: contains Toggle Auto-Scroll, Change Password, and nested Themes -->
      <li class="mobile-submenu" role="none">
        <button
          class="mobile-submenu-toggle"
          aria-expanded="false"
          aria-controls="mobileSettingsList"
          type="button">
          Settings
          <span class="mobile-submenu-caret" aria-hidden="true">▸</span>
        </button>

        <ul id="mobileSettingsList" class="mobile-submenu-list" role="menu" aria-hidden="true">
          {% if current_user is defined and current_user.username == 'admin' %}
          <li class="mobile-submenu" role="none">
            <button
              class="mobile-submenu-toggle"
              aria-expanded="false"
              aria-controls="mobileTunerList"
              type="button">
              Change Tuner
              <span class="mobile-submenu-caret" aria-hidden="true">▸</span>
            </button>

            <ul id="mobileTunerList" class="mobile-submenu-list" role="menu" aria-hidden="true">
              {% if tuner_names is defined and tuner_names %}
                {% for t in tuner_names %}
                  <li role="none">
                    <a role="menuitem" href="{{ url_for('set_tuner', name=t) }}">{{ t }}</a>
                  </li>
                {% endfor %}
              {% endif %}
              <li class="separator"></li>
              <li role="none">
                <a role="menuitem" href="{{ url_for('change_tuner') }}">Tuner Management…</a>
              </li>
            </ul>
          </li>
          <li role="none"><a role="menuitem" href="{{ url_for('manage_users') }}">Manage Users</a></li>
          <li role="none"><a role="menuitem" href="{{ url_for('view_logs') }}">Logs</a></li>
          <li role="none"><a role="menuitem" href="{{ url_for('about') }}">About</a></li>
          {% endif %}
          <li class="mobile-submenu" role="none">
            <button
              class="mobile-submenu-toggle"
              aria-expanded="false"
              aria-controls="mobileAutoScrollList"
              type="button">
              Auto-Scroll
              <span class="mobile-submenu-caret" aria-hidden="true">▸</span>
            </button>

            <ul id="mobileAutoScrollList" class="mobile-submenu-list" role="menu" aria-hidden="true">
              <li role="none"><a role="menuitem" href="#" id="mobileToggleAutoScroll">Enable/Disable Auto-Scroll</a></li>
              <li class="mobile-submenu" role="none">
                <button
                  class="mobile-submenu-toggle"
                  aria-expanded="false"
                  aria-controls="mobileScrollSpeedList"
                  type="button">
                  Scroll Speed
                  <span class="mobile-submenu-caret" aria-hidden="true">▸</span>
                </button>

                <ul id="mobileScrollSpeedList" class="mobile-submenu-list" role="menu" aria-hidden="true">
                  <li role="none"><a role="menuitem" href="#" data-scroll-speed="slow">Slow</a></li>
                  <li role="none"><a role="menuitem" href="#" data-scroll-speed="medium">Medium</a></li>
                  <li role="none"><a role="menuitem" href="#" data-scroll-speed="fast">Fast</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li role="none"><a role="menuitem" href="{{ url_for('change_password') }}">Change Password</a></li>

          <!-- Nested Themes submenu -->
          <li class="mobile-submenu" role="none">
            <button
              class="mobile-submenu-toggle"
              aria-expanded="false"
              aria-controls="mobileThemesListNested"
              type="button">
              Themes
              <span class="mobile-submenu-caret" aria-hidden="true">▸</span>
            </button>

            <ul id="mobileThemesListNested" class="mobile-submenu-list" role="menu" aria-hidden="true">
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="auto">Auto (System)</a></li>
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="retroiptv">RetroIPTV</a></li>
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="light">Light</a></li>
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="dark">Dark</a></li>
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="retro-aol">AOL / CompuServe</a></li>
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="retro-magazine">TV Guide (Refresh)</a></li>
	      <!--<li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="tvguide1990">TV Guide (Classic)</a></li> -->
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="directv">DirecTV</a></li>
              <li role="none"><a role="menuitem" href="#" data-theme-selector data-theme="comcast">Comcast</a></li>
            </ul>
          </li>

          <!-- Nested Display Size submenu -->
          <li class="mobile-submenu" role="none">
            <button
              class="mobile-submenu-toggle"
              aria-expanded="false"
              aria-controls="mobileDisplaySizeList"
              type="button">
              Display Size
              <span class="mobile-submenu-caret" aria-hidden="true">▸</span>
            </button>

            <ul id="mobileDisplaySizeList" class="mobile-submenu-list" role="menu" aria-hidden="true">
              <li role="none"><a role="menuitem" href="#" data-display-size-selector data-display-size="large">Large</a></li>
              <li role="none"><a role="menuitem" href="#" data-display-size-selector data-display-size="medium">Medium</a></li>
              <li role="none"><a role="menuitem" href="#" data-display-size-selector data-display-size="small">Small</a></li>
            </ul>
          </li>

        </ul>
      </li>

      <li role="none"><a role="menuitem" href="{{ url_for('logout') }}">LOGOUT</a></li>
    </ul>
  </div>
</nav>
