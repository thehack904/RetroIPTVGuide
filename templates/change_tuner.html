<!doctype html>
<html>
<head>
    <title>Change Tuner</title>
    <style>
        body { font-family: Arial, sans-serif; margin:0; display:flex; justify-content:center; align-items:center; height:100vh; }
        .box { padding:20px; border-radius:8px; width:400px; box-sizing:border-box; }
        select, input, button { width:100%; padding:8px; margin:5px 0; border-radius:4px; }
        .toggle { margin-top:10px; cursor:pointer; font-size:0.9em; }
        .back { margin-top:10px; display:block; text-align:center; }

        /* Dark */
        body.dark { background:#111; color:#eee; }
        body.dark .box { background:#222; }
        body.dark select, body.dark input, body.dark button { border:1px solid #444; background:#333; color:#eee; }
        body.dark button { background:#06c; color:#fff; }
        body.dark button:hover { background:#049; }
        body.dark .toggle, body.dark .back { color:#0af; }

        /* Light */
        body.light { background:#fff; color:#000; }
        body.light .box { background:#f3f3f3; }
        body.light select, body.light input, body.light button { border:1px solid #aaa; background:#fff; color:#000; }
        body.light button { background:#06c; color:#fff; }
        body.light button:hover { background:#049; }
        body.light .toggle, body.light .back { color:#06c; }
    </style>
</head>
<body>
    <div class="box">
        <h2>Change IPTV Tuner</h2>
        <form method="POST">
            <label for="tuner">Tuner</label>
            <select name="tuner" id="tuner">
                {% for t in tuners %}
                    <option value="{{ t }}" {% if t == current %}selected{% endif %}>{{ t }}</option>
                {% endfor %}
            </select>

            <label for="m3u">M3U URL</label>
            <input type="text" id="m3u" name="m3u" value="{{ current_urls['M3U'] }}">

            <label for="epg">EPG URL</label>
            <input type="text" id="epg" name="epg" value="{{ current_urls['EPG'] }}">

            <button type="submit" name="update">Update</button>
        </form>

        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for msg in messages %}
                    <p style="color:yellow;">{{ msg }}</p>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="toggle" onclick="toggleTheme()">Toggle Theme</div>
        <a class="back" href="{{ url_for('guide') }}">Back to Guide</a>
    </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const saved = localStorage.getItem("theme") || "dark";
    document.body.classList.add(saved);
});
function toggleTheme() {
    const body = document.body;
    if (body.classList.contains("dark")) {
        body.classList.replace("dark", "light");
        localStorage.setItem("theme", "light");
    } else {
        body.classList.replace("light", "dark");
        localStorage.setItem("theme", "dark");
    }
}
</script>
</body>
</html>

